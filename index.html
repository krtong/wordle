<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Helper</title>
    <link rel="stylesheet" href="src/styles-dark.css">
</head>
<body>
    <div class="container layout-classic">
        <h1>Wordle Helper <a href="v2/index.html" style="font-size: 0.5em; font-weight: 400; opacity: 0.6; text-decoration: none; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; padding: 2px 10px; margin-left: 8px; vertical-align: middle;">Try v2</a></h1>

        <div class="game-board">
            <div class="grid-panel">
                <div class="help-icon-container">
                    <span class="help-icon">?</span>
                    <div class="help-tooltip" id="helpTooltip">
                        <!-- Content set by JavaScript based on device type -->
                    </div>
                </div>
                <div class="grid-area">
                    <div class="grid-container">
                        <div class="grid" id="grid">
                            <!-- 6 rows x 5 columns = 30 tiles -->
                        </div>
                        <div class="row-controls" id="rowControls">
                            <!-- Trash buttons will be added here -->
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button id="clearBtn" class="clear-btn">Clear All</button>
                    <div class="length-control">
                        <label class="length-label" for="wordLengthSelect">Word length</label>
                        <select id="wordLengthSelect" class="length-select">
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5" selected>5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                        </select>
                    </div>
                    <div class="length-control">
                        <label class="length-label" for="solveModeSelect">Mode</label>
                        <select id="solveModeSelect" class="length-select">
                            <option value="normal" selected>Normal</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                    <div class="autofill-toggle">
                        <label class="toggle-label">
                            <input type="checkbox" id="autofillToggle">
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Auto-fill green columns</span>
                        </label>
                    </div>
                </div>
                <div id="modeMessage" class="mode-message" style="display: none;" aria-live="polite"></div>
            </div>

        <div class="constraints-digest" id="constraintsDigest">
            <div class="constraint-row">
                <span class="constraint-label">Excluded:</span>
                <span class="constraint-letters gray-letters" id="excludedLetters">—</span>
            </div>
            <div class="constraint-row">
                <span class="constraint-label">Present:</span>
                <span class="constraint-letters yellow-letters" id="presentLetters">—</span>
            </div>
            <div class="constraint-row">
                <span class="constraint-label">Locked:</span>
                <span class="constraint-letters green-letters" id="lockedLetters">—</span>
            </div>
            <div class="constraint-row">
                <span class="constraint-label">Lists:</span>
                <span class="constraint-meta" id="listCounts">—</span>
            </div>
        </div>
    </div>

        <div class="widgets-container" id="widgetsContainer">
            <div class="widget-section draggable" data-widget="frequency">
                <div class="widget-header">
                    <h3>Letter Frequency in Possible Words</h3>
                    <button id="clearFrequencyFilters" class="small-btn">Clear Filters</button>
                    <div class="widget-controls">
                        <button class="drag-handle">☰</button>
                        <button class="collapse-btn">▾</button>
                    </div>
                </div>
                <div class="widget-content">
                    <div id="letterFrequency" class="letter-frequency"></div>
                </div>
            </div>

            <div class="widget-section draggable" data-widget="results">
                <div class="widget-header">
                    <h3>Possible Words (<span id="wordCount">0</span>)</h3>
                    <div class="header-toggle">
                        <label class="toggle-label compact">
                            <input type="checkbox" id="advancedModeToggle">
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Archived Models</span>
                        </label>
                    </div>
                    <div class="widget-controls">
                        <button class="drag-handle">☰</button>
                        <button class="collapse-btn">▾</button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="control-groups">
                <div class="score-controls" id="scoreControls" style="display: none;">
                    <label>Score By (select 1-2):</label>
                    <button class="score-btn active" data-score="positional-frequency" data-mode="basic">Positional Frequency</button>
                    <button class="score-btn active" data-score="language-frequency" data-mode="basic">Common Usage</button>
                    <button class="score-btn" data-score="positional-entropy" data-mode="basic">Positional Entropy</button>
                    <button class="score-btn archived" data-score="frequency" data-mode="advanced">Frequency</button>
                    <button class="score-btn archived" data-score="presence" data-mode="advanced">Presence</button>
                    <button class="score-btn archived" data-score="contingency" data-mode="advanced">Contingency</button>
                    <button class="score-btn archived" data-score="probe" data-mode="advanced">Probe</button>
                    <button class="score-btn archived" data-score="entropy" data-mode="advanced">Entropy</button>
                    <button class="score-btn archived" data-score="expected" data-mode="advanced">Expected</button>
                    <button class="score-btn archived" data-score="minimax" data-mode="advanced">Minimax</button>
                    <button class="score-btn" data-score="positional-entropy-heuristic" data-mode="advanced">Pos. Entropy+</button>
                    <button class="score-btn" data-score="positional-pattern" data-mode="advanced">Pos. Pattern</button>
                    <button class="score-btn" data-score="positional-weight" data-mode="advanced">Pos. Weight</button>
                </div>
                <div id="blendSlider" class="blend-slider-container">
                    <div class="blend-slider-labels">
                        <span id="blendLabel1" class="blend-label-left">Positional Frequency</span>
                        <span id="blendLabel2" class="blend-label-right">Common Usage</span>
                    </div>
                    <div class="blend-slider-row">
                        <input type="range" id="blendSliderInput" class="blend-slider" min="1" max="100" value="50">
                        <input type="number" id="blendNumberInput" class="blend-number" min="1" max="100" value="50">
                    </div>
                    <div class="blend-gradient-bar" id="blendGradientBar"></div>
                </div>
                <div class="filter-toggle-row">
                    <label class="toggle-label">
                        <input type="checkbox" id="hideDoubleLettersToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Hide words with double letters</span>
                    </label>
                </div>
                </div>
                <div id="scoringStatus" class="scoring-status" style="display: none;">
                    <div class="scoring-status-row">
                        <div class="scoring-spinner"></div>
                        <div class="scoring-text">
                            <div id="scoringStatusTitle" class="scoring-title">Calculating…</div>
                            <div id="scoringStatusDetail" class="scoring-detail"></div>
                        </div>
                        <button id="cancelScoringBtn" class="small-btn">Cancel</button>
                    </div>
                    <div class="scoring-progress">
                        <div id="scoringProgressFill" class="scoring-progress-fill"></div>
                    </div>
                </div>
                    <div id="probeSuggestions" class="probe-suggestions" style="display: none;">
                        <div class="probe-suggestions-top">
                            <h4>Next Guess</h4>
                            <div id="probeSuggestionsHint" class="probe-hint"></div>
                        </div>
                        <div id="probeSuggestionsList" class="probe-suggestions-list"></div>
                    </div>
                    <div id="wordList" class="word-list"></div>
                </div>
            </div>

            <div class="widget-section draggable collapsed" data-widget="art">
                <div class="widget-header">
                    <h3>Wordle Art Planner</h3>
                    <div class="widget-controls">
                        <button class="drag-handle">☰</button>
                        <button class="collapse-btn">▸</button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="instructions">
                        <p>Drag any pattern below into the art grid rows to create your design.</p>
                    </div>
                    <div class="art-controls">
                        <div class="answer-controls">
                            <label>Correct answer:</label>
                            <input type="text" id="correctWord" class="answer-input" placeholder="Enter answer" maxlength="5">
                            <button id="clearAnswer" class="small-btn">Clear</button>
                        </div>
                        <button id="clearArt" class="small-btn">Clear Art Grid</button>
                    </div>
                    <div class="art-planner-layout">
                        <div class="art-grid-section">
                            <div class="grid art-grid" id="artGrid"></div>
                        </div>
                        <div class="pattern-library-section">
                            <div class="pattern-library-header">
                                <h4>Available Patterns (<span id="patternCount">0</span>)</h4>
                            </div>
                            <div id="patternLibrary" class="pattern-library"></div>
                        </div>
                    </div>
                    <div id="artResults" class="art-results">
                        <div class="art-row">
                            <div class="art-row-label">Row 1</div>
                            <div id="artResultsRow0" class="art-row-suggestions"></div>
                        </div>
                        <div class="art-row">
                            <div class="art-row-label">Row 2</div>
                            <div id="artResultsRow1" class="art-row-suggestions"></div>
                        </div>
                        <div class="art-row">
                            <div class="art-row-label">Row 3</div>
                            <div id="artResultsRow2" class="art-row-suggestions"></div>
                        </div>
                        <div class="art-row">
                            <div class="art-row-label">Row 4</div>
                            <div id="artResultsRow3" class="art-row-suggestions"></div>
                        </div>
                        <div class="art-row">
                            <div class="art-row-label">Row 5</div>
                            <div id="artResultsRow4" class="art-row-suggestions"></div>
                        </div>
                        <div class="art-row">
                            <div class="art-row-label">Row 6</div>
                            <div id="artResultsRow5" class="art-row-suggestions"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="widget-section draggable collapsed" data-widget="filter">
                <div class="widget-header">
                    <h3>Letter Filter</h3>
                    <div class="widget-controls">
                        <button class="drag-handle">☰</button>
                        <button class="collapse-btn">▸</button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="perPositionToggle" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Per-position filtering</span>
                            </label>
                        </div>

                        <!-- Whole word mode inputs (hidden by default) -->
                        <div id="wholeWordInputs" style="display: none;">
                            <div class="filter-group">
                                <label>Exclude letters:</label>
                                <input type="text" id="excludeLetters" class="filter-input" placeholder="e.g., xyz" maxlength="26">
                                <button id="clearExclude" class="small-btn">Clear</button>
                            </div>
                            <div class="filter-group">
                                <label>Include letters (override):</label>
                                <input type="text" id="includeLetters" class="filter-input" placeholder="e.g., abc" maxlength="26">
                                <button id="clearInclude" class="small-btn">Clear</button>
                            </div>
                        </div>

                        <!-- Per-position mode inputs (shown by default) -->
                        <div id="perPositionInputs">
                            <div class="filter-group">
                                <label>Exclude at positions:</label>
                                <div class="position-inputs">
                                    <input type="text" class="position-input" data-pos="0" placeholder="1" maxlength="26">
                                    <input type="text" class="position-input" data-pos="1" placeholder="2" maxlength="26">
                                    <input type="text" class="position-input" data-pos="2" placeholder="3" maxlength="26">
                                    <input type="text" class="position-input" data-pos="3" placeholder="4" maxlength="26">
                                    <input type="text" class="position-input" data-pos="4" placeholder="5" maxlength="26">
                                </div>
                                <button id="clearPositionExclude" class="small-btn">Clear</button>
                            </div>
                            <div class="filter-group">
                                <label>Include at positions:</label>
                                <div class="position-inputs">
                                    <input type="text" class="position-include-input" data-pos="0" placeholder="1" maxlength="26">
                                    <input type="text" class="position-include-input" data-pos="1" placeholder="2" maxlength="26">
                                    <input type="text" class="position-include-input" data-pos="2" placeholder="3" maxlength="26">
                                    <input type="text" class="position-include-input" data-pos="3" placeholder="4" maxlength="26">
                                    <input type="text" class="position-include-input" data-pos="4" placeholder="5" maxlength="26">
                                </div>
                                <button id="clearPositionInclude" class="small-btn">Clear</button>
                            </div>
                        </div>
                        <div class="filter-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="excludeGreenToggle" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Exclude green letters</span>
                            </label>
                        </div>
                        <div class="filter-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="excludeYellowToggle">
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Exclude yellow letters</span>
                            </label>
                        </div>
                        <div class="filter-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="allowProbeToggle" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Allow non-candidate probes</span>
                            </label>
                        </div>

	                        <div class="filter-group">
	                            <label>Exclude letters (global):</label>
	                            <input type="text" id="globalExcludeLetters" class="filter-input" placeholder="e.g., cegmp" maxlength="26">
	                        </div>
                    </div>
                </div>
            </div>

            <div class="widget-section draggable collapsed" data-widget="invalid-words">
                <div class="widget-header">
                    <h3>Not Allowed Words (<span id="invalidWordsCountWidget">0</span>)</h3>
                    <div class="widget-controls">
                        <button class="drag-handle">☰</button>
                        <button class="collapse-btn">▸</button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="filter-controls">
                        <div class="filter-group">
                            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
                                <button id="invalidWordsCopyBtn" class="small-btn">Copy</button>
                                <button id="invalidWordsClearBtn" class="small-btn">Clear</button>
                                <span id="invalidWordsWidgetStatus" style="opacity:0.8; font-size:12px;"></span>
                            </div>
                            <textarea id="invalidWordsTextarea" class="invalid-words-textarea" readonly placeholder="(empty)"></textarea>
                        </div>
                        <div class="filter-group">
                            <label>Remove (paste words):</label>
                            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
                                <textarea id="invalidWordsBulkRemove" class="invalid-words-textarea" placeholder="e.g.\nXYLYL\nABCD\n…"></textarea>
                                <button id="invalidWordsBulkRemoveBtn" class="small-btn">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="src/wordlist.js"></script>
    <script src="src/wordlists-curated.js"></script>
    <script src="src/modern_word_frequency.js"></script>
    <script src="src/settings-manager.js"></script>
    <script src="src/script.js"></script>
</body>
</html>
