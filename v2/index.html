<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Helper v2</title>
    <link rel="stylesheet" href="styles-v2.css">
</head>
<body>
    <!-- ── Header ────────────────────────────── -->
    <header class="v2-header">
        <h1>Wordle Helper</h1>
        <div class="v2-header-controls">
            <div class="length-control">
                <label class="length-label" for="wordLengthSelect">Letters</label>
                <select id="wordLengthSelect" class="length-select">
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5" selected>5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                </select>
            </div>
            <div class="length-control">
                <label class="length-label" for="solveModeSelect">Mode</label>
                <select id="solveModeSelect" class="length-select">
                    <option value="normal" selected>Normal</option>
                    <option value="hard">Hard</option>
                </select>
            </div>
            <button id="clearBtn" class="clear-btn">Clear</button>
            <a href="../index.html" class="version-link">Classic UI</a>
        </div>
    </header>

    <!-- ── Main: Grid + Results side by side ── -->
    <div class="v2-main">
        <!-- Left: Grid panel -->
        <div class="v2-grid-panel">
            <div class="help-icon-container">
                <span class="help-icon">?</span>
                <div class="help-tooltip" id="helpTooltip"></div>
            </div>

            <div class="grid-area">
                <div class="grid-container">
                    <div class="grid" id="grid">
                        <!-- 6 rows x WORD_LENGTH tiles generated by script.js -->
                    </div>
                    <div class="row-controls" id="rowControls"></div>
                </div>
            </div>

            <div class="controls">
                <div class="autofill-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="autofillToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Auto-fill greens</span>
                    </label>
                </div>
            </div>

            <div id="modeMessage" class="mode-message" style="display: none;" aria-live="polite"></div>

            <div class="constraints-digest" id="constraintsDigest">
                <div class="constraint-row">
                    <span class="constraint-label">Excluded:</span>
                    <span class="constraint-letters gray-letters" id="excludedLetters">&mdash;</span>
                </div>
                <div class="constraint-row">
                    <span class="constraint-label">Present:</span>
                    <span class="constraint-letters yellow-letters" id="presentLetters">&mdash;</span>
                </div>
                <div class="constraint-row">
                    <span class="constraint-label">Locked:</span>
                    <span class="constraint-letters green-letters" id="lockedLetters">&mdash;</span>
                </div>
                <div class="constraint-row">
                    <span class="constraint-label">Lists:</span>
                    <span class="constraint-meta" id="listCounts">&mdash;</span>
                </div>
            </div>
        </div>

        <!-- Right: Results panel -->
        <div class="v2-results-panel">
            <div class="v2-results-header">
                <h3>Possible Words (<span id="wordCount">0</span>)</h3>
                <div class="header-toggle">
                    <label class="toggle-label compact">
                        <input type="checkbox" id="advancedModeToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Archived Models</span>
                    </label>
                </div>
            </div>

            <div class="v2-results-scroll">
                <div class="control-groups">
                    <div class="score-controls" id="scoreControls" style="display: none;">
                        <label>Score By (select 1-2):</label>
                        <button class="score-btn active" data-score="positional-frequency" data-mode="basic">Positional Frequency</button>
                        <button class="score-btn active" data-score="language-frequency" data-mode="basic">Common Usage</button>
                        <button class="score-btn" data-score="positional-entropy" data-mode="basic">Positional Entropy</button>
                        <button class="score-btn archived" data-score="frequency" data-mode="advanced">Frequency</button>
                        <button class="score-btn archived" data-score="presence" data-mode="advanced">Presence</button>
                        <button class="score-btn archived" data-score="contingency" data-mode="advanced">Contingency</button>
                        <button class="score-btn archived" data-score="probe" data-mode="advanced">Probe</button>
                        <button class="score-btn archived" data-score="entropy" data-mode="advanced">Entropy</button>
                        <button class="score-btn archived" data-score="expected" data-mode="advanced">Expected</button>
                        <button class="score-btn archived" data-score="minimax" data-mode="advanced">Minimax</button>
                        <button class="score-btn" data-score="positional-entropy-heuristic" data-mode="advanced">Pos. Entropy+</button>
                        <button class="score-btn" data-score="positional-pattern" data-mode="advanced">Pos. Pattern</button>
                        <button class="score-btn" data-score="positional-weight" data-mode="advanced">Pos. Weight</button>
                    </div>
                    <div id="blendSlider" class="blend-slider-container">
                        <div class="blend-slider-labels">
                            <span id="blendLabel1" class="blend-label-left">Positional Frequency</span>
                            <span id="blendLabel2" class="blend-label-right">Common Usage</span>
                        </div>
                        <div class="blend-slider-row">
                            <input type="range" id="blendSliderInput" class="blend-slider" min="1" max="100" value="50">
                            <input type="number" id="blendNumberInput" class="blend-number" min="1" max="100" value="50">
                        </div>
                        <div class="blend-gradient-bar" id="blendGradientBar"></div>
                    </div>
                    <div class="filter-toggle-row">
                        <label class="toggle-label">
                            <input type="checkbox" id="hideDoubleLettersToggle">
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Hide words with double letters</span>
                        </label>
                    </div>
                </div>

                <div id="scoringStatus" class="scoring-status" style="display: none;">
                    <div class="scoring-status-row">
                        <div class="scoring-spinner"></div>
                        <div class="scoring-text">
                            <div id="scoringStatusTitle" class="scoring-title">Calculating&hellip;</div>
                            <div id="scoringStatusDetail" class="scoring-detail"></div>
                        </div>
                        <button id="cancelScoringBtn" class="small-btn">Cancel</button>
                    </div>
                    <div class="scoring-progress">
                        <div id="scoringProgressFill" class="scoring-progress-fill"></div>
                    </div>
                </div>

                <div id="probeSuggestions" class="probe-suggestions" style="display: none;">
                    <div class="probe-suggestions-top">
                        <h4>Next Guess</h4>
                        <div id="probeSuggestionsHint" class="probe-hint"></div>
                    </div>
                    <div id="probeSuggestionsList" class="probe-suggestions-list"></div>
                </div>

                <div id="wordList" class="word-list"></div>
            </div>
        </div>
    </div>

    <!-- ── Tool Tabs ─────────────────────────── -->
    <div class="v2-tool-bar">
        <div class="v2-tab-row">
            <button class="v2-tab-btn" data-panel="frequency">Frequency</button>
            <button class="v2-tab-btn" data-panel="filter">Filter</button>
            <button class="v2-tab-btn" data-panel="art">Art Planner</button>
        </div>

        <!-- Frequency panel -->
        <div class="v2-tool-panel" data-panel="frequency">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <h4 style="margin: 0; font-size: 0.9rem;">Letter Frequency in Possible Words</h4>
                <button id="clearFrequencyFilters" class="small-btn">Clear Filters</button>
            </div>
            <div id="letterFrequency" class="letter-frequency"></div>
        </div>

        <!-- Filter panel -->
        <div class="v2-tool-panel" data-panel="filter">
            <div class="filter-controls">
                <div class="filter-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="perPositionToggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Per-position filtering</span>
                    </label>
                </div>

                <div id="wholeWordInputs" style="display: none;">
                    <div class="filter-group">
                        <label>Exclude letters:</label>
                        <input type="text" id="excludeLetters" class="filter-input" placeholder="e.g., xyz" maxlength="26">
                        <button id="clearExclude" class="small-btn">Clear</button>
                    </div>
                    <div class="filter-group">
                        <label>Include letters (override):</label>
                        <input type="text" id="includeLetters" class="filter-input" placeholder="e.g., abc" maxlength="26">
                        <button id="clearInclude" class="small-btn">Clear</button>
                    </div>
                </div>

                <div id="perPositionInputs">
                    <div class="filter-group">
                        <label>Exclude at positions:</label>
                        <div class="position-inputs">
                            <input type="text" class="position-input" data-pos="0" placeholder="1" maxlength="26">
                            <input type="text" class="position-input" data-pos="1" placeholder="2" maxlength="26">
                            <input type="text" class="position-input" data-pos="2" placeholder="3" maxlength="26">
                            <input type="text" class="position-input" data-pos="3" placeholder="4" maxlength="26">
                            <input type="text" class="position-input" data-pos="4" placeholder="5" maxlength="26">
                        </div>
                        <button id="clearPositionExclude" class="small-btn">Clear</button>
                    </div>
                    <div class="filter-group">
                        <label>Include at positions:</label>
                        <div class="position-inputs">
                            <input type="text" class="position-include-input" data-pos="0" placeholder="1" maxlength="26">
                            <input type="text" class="position-include-input" data-pos="1" placeholder="2" maxlength="26">
                            <input type="text" class="position-include-input" data-pos="2" placeholder="3" maxlength="26">
                            <input type="text" class="position-include-input" data-pos="3" placeholder="4" maxlength="26">
                            <input type="text" class="position-include-input" data-pos="4" placeholder="5" maxlength="26">
                        </div>
                        <button id="clearPositionInclude" class="small-btn">Clear</button>
                    </div>
                </div>

                <div class="filter-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="excludeGreenToggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Exclude green letters</span>
                    </label>
                </div>
                <div class="filter-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="excludeYellowToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Exclude yellow letters</span>
                    </label>
                </div>
                <div class="filter-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="allowProbeToggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Allow non-candidate probes</span>
                    </label>
                </div>

	                <div class="filter-group">
	                    <label>Exclude letters (global):</label>
	                    <input type="text" id="globalExcludeLetters" class="filter-input" placeholder="e.g., cegmp" maxlength="26">
	                </div>
            </div>
        </div>

        <!-- Art Planner panel -->
        <div class="v2-tool-panel" data-panel="art">
            <div class="instructions">
                <p>Drag any pattern below into the art grid rows to create your design.</p>
            </div>
            <div class="art-controls">
                <div class="answer-controls">
                    <label>Correct answer:</label>
                    <input type="text" id="correctWord" class="answer-input" placeholder="Enter answer" maxlength="5">
                    <button id="clearAnswer" class="small-btn">Clear</button>
                </div>
                <button id="clearArt" class="small-btn">Clear Art Grid</button>
            </div>
            <div class="art-planner-layout">
                <div class="art-grid-section">
                    <div class="grid art-grid" id="artGrid"></div>
                </div>
                <div class="pattern-library-section">
                    <div class="pattern-library-header">
                        <h4>Available Patterns (<span id="patternCount">0</span>)</h4>
                    </div>
                    <div id="patternLibrary" class="pattern-library"></div>
                </div>
            </div>
            <div id="artResults" class="art-results">
                <div class="art-row">
                    <div class="art-row-label">Row 1</div>
                    <div id="artResultsRow0" class="art-row-suggestions"></div>
                </div>
                <div class="art-row">
                    <div class="art-row-label">Row 2</div>
                    <div id="artResultsRow1" class="art-row-suggestions"></div>
                </div>
                <div class="art-row">
                    <div class="art-row-label">Row 3</div>
                    <div id="artResultsRow2" class="art-row-suggestions"></div>
                </div>
                <div class="art-row">
                    <div class="art-row-label">Row 4</div>
                    <div id="artResultsRow3" class="art-row-suggestions"></div>
                </div>
                <div class="art-row">
                    <div class="art-row-label">Row 5</div>
                    <div id="artResultsRow4" class="art-row-suggestions"></div>
                </div>
                <div class="art-row">
                    <div class="art-row-label">Row 6</div>
                    <div id="artResultsRow5" class="art-row-suggestions"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared scripts (relative paths to ../src/) -->
    <script src="../src/wordlist.js"></script>
    <script src="../src/wordlists-curated.js"></script>
    <script src="../src/modern_word_frequency.js"></script>
    <script src="../src/settings-manager.js"></script>
    <script src="../src/script.js"></script>

    <!-- Tab toggle behavior -->
    <script>
    (function() {
        const tabs = document.querySelectorAll('.v2-tab-btn');
        const panels = document.querySelectorAll('.v2-tool-panel');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const panelName = tab.dataset.panel;
                const wasActive = tab.classList.contains('active');

                // Close all
                tabs.forEach(t => t.classList.remove('active'));
                panels.forEach(p => p.classList.remove('active'));

                // Toggle (if it wasn't already open, open it)
                if (!wasActive) {
                    tab.classList.add('active');
                    document.querySelector(`.v2-tool-panel[data-panel="${panelName}"]`).classList.add('active');
                }
            });
        });
    })();
    </script>
</body>
</html>
